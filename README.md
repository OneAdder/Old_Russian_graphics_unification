# Библиотека unification
Мы создали библиотеку `unification.pyx`. 
Для работы с библиотекой требуется установить пакет `cython3`. Далее её можно импортировать следующим образом:
```
import pyximport; pyximport.install()
import unification
```
Эта библиотека на языке Cython содержит ряд полезных для работы с древнерусскими вариантами написания функций.

### unify
unification.**unify** принимает слово `str` и приводит его к единому формату. Таким образом, можно сравнить два слова: если они одинаковые (например, "вседержитель" и "вьседержитель"), то `unify` выдаст один результат для обоих слов.  
```
>>> unify('вьседержителъ')
'въсєдєръжитєлъ'
>>> unify('всєдєржитєль')
'въсєдєръжитєлъ'
```
### all_options
unification.**all_options** принимает слово `str` и выводит все способы перевода в унифицированную графику, учитывая разнообразие способов постановки редуцированных. 
```
>>> all_options('мълъва')
('молъва', 'мълъва', 'молъва')
```
Данная функцию нужна, так как не всегда можно предугадать все возможные позиции редуцированных (`unify` лишь даёт наиболее вероятный вариант).  
Пока не найдено нормальное слово, где это может пригодиться, так что пример ниже искуственный. Как видно функция `unify` выдаёт разные варианты для слов, которые требуется сметчить, в том время как `all_options` выдаёт кортеж, который содержит вариант, введённый во втором вызове функции `unify`, а также вывод обоих вызовов этой функции.  
Этот даёт возможность сметчить варианты "тъттъ", "тотътъ", "тътътъ" и "тътотъ".
```
>>> unify('тъттъ')
'тотътъ'
>>> unify('тътътъ')
'тътотъ'
>>> all_options('тъттъ')
('тотътъ', 'тътътъ', 'тътотъ')
```
### compare
unification.**compare** принимает два слова `str`, сравнивает, если формы одинаковые, то возвращает унифицированную форму, совместимую с выводом функции `unify`. Если слова нужно сметчить, то функция возвращает слово в унифицированном виде. Если слова разные, функция не возвращает ничего.  
Данная функция так же поддерживает расширенную проверку позиций редуцированных, однако не рекомендуется к использованию, если вы подозреваете что такое (лучше присмотреться к `safe_conparison`).
```
>>> compare('вьседержителъ', 'всєдєржитєль')
'въсєдєръжитєлъ'
>>> compare('тътътъ', 'тътотъ')
'тътотъ'
>>> compare('тътътъ', 'тъттъ')
'тътотъ'
```
### full_comparison
unification.**full_comparison** принимает два слова `str`, сравнивает и выдаёт все варианты, совпадающие для обоих слов.
```
>>> all_options('тъттъ')
('тотътъ', 'тътътъ', 'тътотъ')
>>> all_options('тътътъ')
('тътотъ', 'тътътъ', 'тътотъ')
>>> full_comparison('тъттъ', 'тътътъ')
['тътътъ', 'тътотъ', 'тътотъ']
```
### safe_comparison
unification.**safe_comparison** принимает два слова `str`, сравнивает.
Если есть совпадающие варианты, и хотя бы один из них совпадает с `unify(первое_слово)` или `unify(второе_слово)`, то возвращает именно этот вариант.
В противном случае не возвращает ничего. Если совпадений несколько, выдаётся первое. То есть в том порядке, как это писано в разделе про алгоритм.
```
>>> safe_comparison('тъттъ', 'тътътъ')
'тътотъ'
>>> safe_comparison('тттъ', 'тътътъ')
'тътътъ'
```

## Алгоритм унификации
### Алгоритм сделан на основе статей:
* "Автоматический морфологический анализатор древнерусского языка: лингвистические и технологические решения"
Баранов, Миронов, Лапин, Мельникова, Соколова, Корепанова.

* "ВЗIAЛЪ, ВЪЗЯЛЪ, ВЬЗЯЛ: ОБРАБОТКА ОРФОГРАФИЧЕСКОЙ ВАРИАТИВНОСТИ ПРИ ЛЕКСИКО-ГРАММАТИЧЕСКОЙ АННОТАЦИИ СТАРОРУССКОГО КОРПУСА XV–XVII ВВ." Т. С. Г АВРИЛОВА, Т. А. ШАЛГАНОВА, О. Н. ЛЯШЕВСКАЯ.

### Порядок действий
1. Привести к нижнему регистру, удалить лишние знаки и т.д.
2. Привести равнозначные знаки и фонологически незначимые отличия к единой форме. Подробнее см. докстринги `unify_various_symbols`.
3. Привести конечный редуцированный в "ъ".
4. Уменьшить разнообразие гласные после после шипящих. Подробнее см. докстринги `unify_vowels_after_set1`.
5. Дезйотировать гласные в позиции начала слова и после гласных. Подробнее см. докстринги unify_iotated
6. Перевести "ь" после йотированных гласных и "i" в "и".
7. Преобразовать ряд сочетаний плавных с гласными. Подробнее см. докстринги `unify_r_and_l_with_shwas1`, `unify_r_and_l_with_shwas2` и `unify_r_and_l_with_yat`.
8. Сровнять высокый и высокий (прилагательные с основой на велярный).
9. Эмулировать падение редуцированных.
10. Добавить принцип открытого слога.

Последние два пункта используются в функции `unify`. В функциях `all_options`, `compare`, `full_comparison` и `safe_comparison` используется растроение возможного положения редуцированных. Сравнивается слово, полученное пунктами 1-7.
В слове проставляются редуцированные тремя способами:
1. Редуцированные упали/прояснились, "ъ" возник по принципу открытого слога.
2. "ъ" возник по принципу открытого слога.
4. "ъ" возник по принципу открытого слога, редуцированные упали/прояснились, "ъ" возник по принципу открытого слога.

Как видно первый вариант является стандартным алгоритмом и результат его работы совпадает с выводом функции `unify`. Остальные два варианта отличаются.
